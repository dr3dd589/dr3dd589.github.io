<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta name="generator" content="Jekyll">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">
  <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#5bbad5">

  <title>Razer Cortex Unquoted Search path Vulnerability - $750 USD</title>

  <link rel="stylesheet" href="/css/main.css">
  
<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5c03915b806598ee"></script>

  
  <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" /> <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Razer Cortex Unquoted Search path Vulnerability - $750 USD | dr3dd</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Razer Cortex Unquoted Search path Vulnerability - $750 USD" />
<meta name="author" content="dr3dd" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I found this bug in Razer Cortex Service vesion 7.3.23.124 .By default RzKLService.exe runs with system privileges, and it executes RazerCortex.exe with administrator privileges but the way its load this binary i.e RazerCortex.exe is vulnerable to Unquoted Search path Vulnerability. So any attacker to can executes its binary which is places in these two paths:- C:\Program.exe and C:\Program Files (x86)\Razer\Razer.exe which is not present. So if an attacker places their malicious binary at this place, then whenever the user logged in it, attacker binary executes with administrator privilege." />
<meta property="og:description" content="I found this bug in Razer Cortex Service vesion 7.3.23.124 .By default RzKLService.exe runs with system privileges, and it executes RazerCortex.exe with administrator privileges but the way its load this binary i.e RazerCortex.exe is vulnerable to Unquoted Search path Vulnerability. So any attacker to can executes its binary which is places in these two paths:- C:\Program.exe and C:\Program Files (x86)\Razer\Razer.exe which is not present. So if an attacker places their malicious binary at this place, then whenever the user logged in it, attacker binary executes with administrator privilege." />
<meta property="og:site_name" content="dr3dd" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-10T17:01:19+05:30" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"/bug-bounty/2020/07/10/Razer-Unquoted-Search-Path-Vulnerability/","headline":"Razer Cortex Unquoted Search path Vulnerability - $750 USD","dateModified":"2020-07-10T17:01:19+05:30","datePublished":"2020-07-10T17:01:19+05:30","author":{"@type":"Person","name":"dr3dd"},"description":"I found this bug in Razer Cortex Service vesion 7.3.23.124 .By default RzKLService.exe runs with system privileges, and it executes RazerCortex.exe with administrator privileges but the way its load this binary i.e RazerCortex.exe is vulnerable to Unquoted Search path Vulnerability. So any attacker to can executes its binary which is places in these two paths:- C:\\Program.exe and C:\\Program Files (x86)\\Razer\\Razer.exe which is not present. So if an attacker places their malicious binary at this place, then whenever the user logged in it, attacker binary executes with administrator privilege.","mainEntityOfPage":{"@type":"WebPage","@id":"/bug-bounty/2020/07/10/Razer-Unquoted-Search-Path-Vulnerability/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
  <div id="wrapper">
    <header>
  <div>
    <a href="/">
    
    <h1>./dr3dd</h1>
    </a>
    <div class="header-links">
      <h2>Cybersecurity Enthusiast</h2>
      <a href="/archive"><h2 class="header-link">Blogs</h2></a>
<a href="/about"><h2 class="header-link">About</h2></a>
<a href="/favicon/resume.pdf"><h2 class="header-link">Resume</h2></a>
<!-- <a href="/atom.xml"><h2 class="header-link">RSS</h2></a> -->
    </div>
  </div>
</header>
    <div class="container">
      <section id="main_content">
        

<div class="container-fluid single">
  <div class="row">

    <div itemscope itemtype="http://schema.org/Article" class="col-md-12 article">
      
      <div class="thumb">
        <i class="fa fa-book fa-4x"></i>
      </div>
      

      <h1 class="header" itemprop="name">Razer Cortex Unquoted Search path Vulnerability - $750 USD</h1>

      <div class="author">
        <small><i>
          
          by
          <span itemprop="author">
            
              <a rel="author" href="https://plus.google.com/u/0/115811810791350463594">
            
            <span itemprop="author" itemscope itemtype="http://schema.org/Person">
              <span itemprop="name">dr3dd</span>
            </span>
            
              </a>
            
          </span>
          
          on <span itemprop="datePublished" content="2014-08-28">July 10, 2020</span>
           under Bug-Bounty
        </i></small>
      </div>

      <div class="read-time">
        <small>
          1 minute read
        </small>
      </div>

      <div class="content-panel content">

        

        <span itemprop="articleBody"><p>I found this bug in Razer Cortex Service vesion <code class="highlighter-rouge">7.3.23.124</code> .By default <code class="highlighter-rouge">RzKLService.exe</code> runs with system privileges, and it executes <code class="highlighter-rouge">RazerCortex.exe</code> with administrator privileges but the way its load this binary i.e <code class="highlighter-rouge">RazerCortex.exe</code> is vulnerable to <code class="highlighter-rouge">Unquoted Search path Vulnerability</code>. So any attacker to can executes its binary which is places in these two paths:-
<code class="highlighter-rouge">C:\Program.exe</code> and <code class="highlighter-rouge">C:\Program Files (x86)\Razer\Razer.exe</code> which is not present. So if an attacker places their malicious binary at this place, then whenever the  user logged in it, attacker binary executes with administrator privilege.</p>

<h3 id="root-cause-of-this-vulnerability">Root Cause of this Vulnerability</h3>

<p>On Reversing <code class="highlighter-rouge">RzKLService.exe</code> i found that it excutes <code class="highlighter-rouge">RazerCortex.exe</code> after concating <code class="highlighter-rouge">-systray</code> in <code class="highlighter-rouge">RazerCortex.exe</code> path. So final  with argument becomes
<code class="highlighter-rouge">C:\Program Files (x86)\Razer\Razer Cortex\RazerCortex.exe -systray</code> there is no quotes between path spaces and argument. and that’s why it’s happening.</p>

<p>Vulnerable code -</p>

<pre><code class="language-C">  print_log((int)L"Run main processex[0] %s %s", path_ptr, v33);
  sub_402FA0((void **)&amp;v34, L"RazerCortex.exe");
  LOBYTE(v37) = 10;
  cancat((int)&amp;path_ptr, (int)L" %s", v33);
</code></pre>
<p>Above psudo code decompile by IDA. <br />
here v33 = <code class="highlighter-rouge">-systray</code> <br />
path_ptr = <code class="highlighter-rouge">C:\Program Files (x86)\Razer\Razer Cortex\RazerCortex.exe</code></p>

<p>Reported on Hackerone, link is below :<br />
<a href="https://hackerone.com/reports/769684">Razer-hackerone-report</a><br />
Similar bug reference :-<br />
<a href="https://hackerone.com/redirect?url=https%3A%2F%2Fsafebreach.com%2FPost%2FMaxthon-Browser-for-Windows-Unquoted-Search-Path-and-Potential-Abuses-CVE-2019-16647">Safebreach-Windows-Unquoted-Search-Path-CVE-2019-16647</a></p>
</span>

        

        
        <div class="share">
          <!-- Go to www.addthis.com/dashboard to customize your tools -->
          <div class="addthis_sharing_toolbox"></div>
        </div>
        

        
        <div class="tags">
          <small>
          <i class="fa fa-tags"></i>
            Bug-Bounty, Windows Code Path Vulnerability, Razer, HackerOne
          </small>
        </div>
        

      </div>

      
      <div class="content-panel feedback">
        I <i class="fa fa-heart"></i> feedback.<br />
        Let me know what you think of this article on twitter <a href="http://www.twitter.com/_dr3dd_">@_dr3dd_</a> or leave a comment below!
      </div>
      

      
      <div class="content-panel comments">
        <div id="disqus_thread">
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
      </div>
      

      

    </div>

  </div>

</div>


<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
function disqus_config() { this.experiment.enable_scroll_container = true; }
var disqus_shortname = "dr3dd"; // required: replace example with your forum shortname
/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>


      </section>
    </div>
  </div>

   <footer>
  <a href="http://dr3dd.me">
    <span>
        <b>dr3dd</b>
    </span>
    
    <span>© 2020</span>
  </a>
</footer>

  
    <script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-20365477-4', 'auto');
  ga('send', 'pageview');
</script>
  
</body>

</html>